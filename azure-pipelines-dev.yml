# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

stages:
 - stage: Dev
   dependsOn: CI
   condition: succeeded('CI')
   displayName: 'Deploy App to Dev Slot'
   jobs:
      - job:  DeployApp
        displayName: 'Deploy App'
        steps:
        - task: DownloadPipelineArtifact@2
          inputs:
            buildType: 'current'
            artifactName: 'drop'
            targetPath: '$(System.DefaultWorkingDirectory)'
        - task: AzureRmWebAppDeployment@4
          inputs:
            ConnectionType: 'AzureRM'
            azureSubscription: 'feb07b51-614b-44d2-9f84-620cf7f5f148'
            appType: 'webApp'
            WebAppName: 'spring-mvc-demo'
            deployToSlotOrASE: true
            ResourceGroupName: 'spring-mvc-demo_group'
            SlotName: 'Dev'
            packageForLinux: '$(System.DefaultWorkingDirectory)/**/*.jar'